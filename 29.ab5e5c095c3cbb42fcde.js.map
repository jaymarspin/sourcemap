{"version":3,"sources":["./src/app/pages/opportunity/opportunity-details/opportunity-details.page.html","./src/app/pages/opportunity/opportunity-details/opportunity-details-routing.module.ts","./src/app/pages/opportunity/opportunity-details/opportunity-details.page.ts","./src/app/components/common/model-interest-selector/model-interest-selector.module.ts","./src/app/pages/opportunity/opportunity-details/opportunity-details.module.ts"],"names":["routes","path","PARAM_ID","children","component","OpportunityDetailsPage","opportunityService","route","router","modalController","translate","loadingCtrl","formBuilder","subs","Subscription","countryCode","environment","customPPDate","PP_DATE_CUSTOM","this","oppForm","initOppForm","add","parseURL","group","name","company","modelInterest","required","warmth","notes","PPD","PPDRange","PPDReason","source","channel","initErrorMessages","opp","paramMap","subscribe","params","Id","get","pipe","mergeMap","lang","from","create","message","loading","present","forkJoin","getOpportunities","getPPRange","getCmpgList","tap","e","isPPDChanged","undefined","updateForm","dismiss","err","o1","o2","getPPDateRange","Company","ppDateRange","opt","label","value","push","today","Date","setMonth","setDate","ppDateMin","toJSON","maxDate","getFullYear","ppDateMax","cmpgList","chnlList","Cmpg","Channel","form","formErrorMessages","key","Object","keys","controls","oppId","getOpportunityById","console","log","IntentStatus","Warmth","reset","ContactName","ModelInterest","Notes","PlannedPurchasedDate","PlannedPurchaseDateRange","PlannedPurchaseDateReason","emitEvent","oppStatus","IsClosed","Type","type","evt","clearValidators","formValues","setValidators","updateValueAndValidity","indexOf","disabled","enable","disable","componentProps","cmp","team","selectedValues","modal","onDidDismiss","modalData","data","selectedModel","map","model","JSON","stringify","setValue","markAsDirty","navigate","BASE","Flag","valid","upsertOpp","res","hasError","Error","getError","save","goToTestdrives","goToTradeIns","goToTasks","showModelInterestComp","changePPD","changeCmpgSource","updateOppStatus","pathMatch","OpportunityDetailsPageRoutingModule","forChild","ModelInterestSelectorModule","OpportunityDetailsPageModule"],"mappings":"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","file":"29.ab5e5c095c3cbb42fcde.js","sourcesContent":["<ion-header class=\"ion-no-border\">\r\n  <ion-toolbar color=\"primary\" mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button defaultHref=\"\" text=\"{{'Common_Back'|translate}}\"></ion-back-button>\r\n    </ion-buttons>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"save()\">{{'Common_Save'|translate}}</ion-button>\r\n    </ion-buttons>\r\n    <ion-title>{{\"OpportunityTab_Opportunity\"|translate}}</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <div class=\"ion-text-center ion-padding\">\r\n    <h2>{{opp?.ContactName}}</h2>\r\n    <ion-icon name=\"{{ getFavIcon(opp) }}\" color=\"primary\" class=\"heart\" *ngIf=\"countryCode == 'my'\"></ion-icon>\r\n    <ion-text class=\"sub\">{{opp?.Source}}</ion-text>\r\n    <!-- 1ST ROW -->\r\n    <div class=\"ion-margin-bottom ion-margin-top\">\r\n      <ion-grid class=\"ion-no-margin ion-no-padding\">\r\n        <ion-row>\r\n          <ion-col>\r\n            <div class=\"header-btn\" (click)=\"goToTestdrives()\">\r\n              <span>\r\n                <ion-icon src=\"assets/icon/opportunity/testdrive.svg\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Testdrive\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col>\r\n            <div class=\"header-btn\" (click)=\"goToTradeIns()\">\r\n              <span>\r\n                <ion-icon src=\"assets/icon/opportunity/tradein.svg\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_TradeIn\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col *ngIf=\"false\">\r\n            <div class=\"header-btn\" (click)=\"goToOffers()\">\r\n              <span>\r\n                <ion-icon name=\"document\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Offer\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col *ngIf=\"false\">\r\n            <div class=\"header-btn\">\r\n              <span>\r\n                <ion-icon src=\"assets/icon/opportunity/booking-disabled.svg\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\" color=\"medium\"> {{\"OpportunityDetails_Booking\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n        </ion-row>\r\n      </ion-grid>\r\n    </div>\r\n    <!-- 2ND ROW -->\r\n    <div class=\"ion-margin-bottom ion-margin-top\">\r\n      <ion-grid class=\"ion-no-margin ion-no-padding\">\r\n        <ion-row>\r\n          <ion-col *ngIf=\"false\">\r\n            <div class=\"header-btn\" (click)=\"goToDeliveries()\">\r\n              <span>\r\n                <ion-icon src=\"assets/icon/opportunity/delivery-disabled.svg\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\" color=\"medium\"> {{\"OpportunityDetails_Delivery\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col *ngIf=\"false\">\r\n            <div class=\"header-btn\" (click)=\"goToActivityLogs()\">\r\n              <span>\r\n                <ion-icon name=\"time\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_ActivityLogs\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col>\r\n            <div class=\"header-btn\" (click)=\"goToTasks()\">\r\n              <span>\r\n                <ion-icon name=\"calendar\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Tasks\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n          <ion-col *ngIf=\"false\">\r\n            <div class=\"header-btn\">\r\n              <span>\r\n                <ion-icon src=\"assets/icon/opportunity/more.svg\" color=\"primary\"></ion-icon>\r\n              </span>\r\n              <div>\r\n                <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Others\"|translate}} </ion-label>\r\n              </div>\r\n            </div>\r\n          </ion-col>\r\n        </ion-row>\r\n      </ion-grid>\r\n    </div>\r\n    <ng-container [formGroup]=\"oppForm\">\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_ModelInterest\"|translate}}</h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-item>\r\n            <ion-input formControlName=\"modelInterest\" placeholder=\"Model Interest\" (ionFocus)=\"showModelInterestComp()\" class=\"w100\"></ion-input>\r\n          </ion-item>\r\n        </div>\r\n      </div>\r\n      <!-- <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">\r\n          {{\"OpportunityDetails_ModelInterest\"|translate}}\r\n        </h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-item lines=\"none\">\r\n            <ion-grid\r\n              class=\"ion-no-margin ion-no-padding ion-text-start pbt-10\"\r\n            >\r\n              <ion-row *ngFor=\"let model of getModelInterest()\">\r\n                <ion-col>\r\n                  <ion-label class=\"ion-text-wrap\">{{model?.label}}</ion-label>\r\n                </ion-col>\r\n              </ion-row>\r\n              <ion-row>\r\n                <ion-icon\r\n                  name=\"add\"\r\n                  color=\"primary\"\r\n                  class=\"ion-align-self-center\"\r\n                ></ion-icon>\r\n                <ion-label class=\"ion-text-wrap\" (click)=\"addModelInterest()\">\r\n                  <a> {{\"OpportunityDetails_AddModelInterest\"|translate}}</a>\r\n                </ion-label>\r\n              </ion-row>\r\n            </ion-grid>\r\n          </ion-item>\r\n        </div>\r\n      </div> -->\r\n      <!-- Planned Purchase Date -->\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_PlannedPurchaseDate\"|translate}}</h4>\r\n        <!-- Date Range (Immediate, Within 3 Months) -->\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-item>\r\n            <ion-select\r\n              interface=\"action-sheet\"\r\n              formControlName=\"PPDRange\"\r\n              placeholder='{{\"OpportunityDetails_PPDRange\"|translate}}'\r\n              (ionChange)=\"changePPD($event)\"\r\n              class=\"w100\"\r\n            >\r\n              <ion-select-option [value]=\"opt.value\" *ngFor=\"let opt of ppDateRange\"> {{ opt.label }}</ion-select-option>\r\n            </ion-select>\r\n          </ion-item>\r\n        </div>\r\n        <!-- Custom Date Selection -->\r\n        <div class=\"ion-margin-bottom ion-margin-top\" *ngIf=\"oppForm.value?.PPDRange === customPPDate\">\r\n          <ion-item>\r\n            <ion-datetime\r\n              displayFormat=\"DD MMM YYYY\"\r\n              [min]=\"ppDateMin\"\r\n              [max]=\"ppDateMax\"\r\n              formControlName=\"PPD\"\r\n              (ionChange)=\"changePPD($event)\"\r\n              placeholder='{{\"OpportunityDetails_PPDDate\"|translate}}'\r\n              class=\"w100\"\r\n            >\r\n            </ion-datetime>\r\n          </ion-item>\r\n          <app-item-err [control]=\"oppForm.controls?.PPD\" [messages]=\"formErrorMessages.PPD\"></app-item-err>\r\n        </div>\r\n        <!-- PPD Reason -->\r\n        <div class=\"ion-margin-bottom ion-margin-top\" *ngIf=\"isPPDChanged\">\r\n          <ion-item lines=\"none\">\r\n            <ion-textarea rows=\"3\" formControlName=\"PPDReason\" placeholder='{{\"OpportunityDetails_PPDReason\"|translate}}' class=\"w100\"></ion-textarea>\r\n          </ion-item>\r\n          <app-item-err [control]=\"oppForm.controls?.PPDReason\" [messages]=\"formErrorMessages.PPDReason\"></app-item-err>\r\n        </div>\r\n      </div>\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_Source\"|translate}}</h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-item>\r\n            <ion-select\r\n              interface=\"action-sheet\"\r\n              formControlName=\"source\"\r\n              (ionChange)=\"changeCmpgSource($event)\"\r\n              [compareWith]=\"compareId\"\r\n              placeholder='{{\"OpportunityDetails_Source\"|translate}}'\r\n              class=\"w100\"\r\n            >\r\n              <ion-select-option [value]=\"opt\" *ngFor=\"let opt of cmpgList\"> {{ opt.Name }}</ion-select-option>\r\n            </ion-select>\r\n          </ion-item>\r\n        </div>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-item>\r\n            <ion-select multiple=\"true\" formControlName=\"channel\" placeholder='{{\"OpportunityDetails_Channel\"|translate}}' class=\"w100\">\r\n              <ion-select-option [value]=\"opt\" *ngFor=\"let opt of chnlList\"> {{ opt }}</ion-select-option>\r\n            </ion-select>\r\n          </ion-item>\r\n        </div>\r\n      </div>\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_LeadStatus\"|translate}}</h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-grid class=\"ion-no-margin ion-no-padding\">\r\n            <ion-row>\r\n              <ion-grid class=\"ion-no-margin ion-no-padding opp-header ion-padding-top\">\r\n                <ion-row>\r\n                  <ion-col> {{\"OpportunityDetails_Cold\"|translate}} </ion-col>\r\n                  <ion-col> {{\"OpportunityDetails_Warm\"|translate}} </ion-col>\r\n                  <ion-col> {{\"OpportunityDetails_Hot\"|translate}} </ion-col>\r\n                </ion-row>\r\n              </ion-grid>\r\n            </ion-row>\r\n            <ion-row>\r\n              <ion-item lines=\"none\" class=\"w100\">\r\n                <ion-range min=\"0\" max=\"100\" step=\"50\" snaps=\"true\" formControlName=\"warmth\" mode=\"ios\" [disabled]=\"countryCode == 'sg'\">\r\n                  <ion-icon slot=\"start\" name=\"snow\" color=\"secondary\"></ion-icon>\r\n                  <ion-icon slot=\"end\" name=\"flame\" color=\"danger\"></ion-icon>\r\n                </ion-range>\r\n              </ion-item>\r\n              <app-item-err [control]=\"oppForm.controls?.warmth\" [messages]=\"formErrorMessages.warmth\"></app-item-err>\r\n            </ion-row>\r\n          </ion-grid>\r\n        </div>\r\n      </div>\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_OpportunityStatus\"|translate}}</h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top\">\r\n          <ion-grid class=\"ion-no-margin ion-no-padding\">\r\n            <ion-row>\r\n              <ion-col>\r\n                <div class=\"header-btn status\" (click)=\"updateOppStatus('open')\">\r\n                  <span>\r\n                    <ion-icon src=\"{{getOppColor('open', opp)}}\"></ion-icon>\r\n                  </span>\r\n                  <div>\r\n                    <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Open\"|translate}} </ion-label>\r\n                  </div>\r\n                </div>\r\n              </ion-col>\r\n              <ion-col>\r\n                <div class=\"header-btn status\" (click)=\"updateOppStatus('closed')\">\r\n                  <span>\r\n                    <ion-icon name=\"close-circle\" color=\"{{getOppColor('closed', opp)}}\"></ion-icon>\r\n                  </span>\r\n                  <div>\r\n                    <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Lost\"|translate}} </ion-label>\r\n                  </div>\r\n                </div>\r\n              </ion-col>\r\n              <ion-col *ngIf=\"countryCode == 'my'\">\r\n                <div class=\"header-btn status\" (click)=\"updateOppStatus('deferred')\">\r\n                  <span>\r\n                    <ion-icon name=\"timer\" color=\"{{getOppColor('deferred', opp)}}\"></ion-icon>\r\n                  </span>\r\n                  <div>\r\n                    <ion-label class=\"mat-small\"> {{\"OpportunityDetails_Deferred\"|translate}} </ion-label>\r\n                  </div>\r\n                </div>\r\n              </ion-col>\r\n            </ion-row>\r\n          </ion-grid>\r\n        </div>\r\n      </div>\r\n      <div class=\"ion-margin-bottom ion-margin-top\">\r\n        <h4 class=\"ion-text-start ion-padding-left\">{{\"OpportunityDetails_Notes\"|translate}}</h4>\r\n        <div class=\"ion-margin-bottom ion-margin-top ion-text-start\">\r\n          <ion-item lines=\"none\">\r\n            <ion-textarea rows=\"6\" formControlName=\"notes\" placeholder='{{\"EditContact_Notes\"|translate}}' readonly=\"true\"></ion-textarea>\r\n          </ion-item>\r\n          <app-item-err [control]=\"oppForm.controls?.notes\" [messages]=\"formErrorMessages.notes\"></app-item-err>\r\n        </div>\r\n      </div>\r\n    </ng-container>\r\n  </div>\r\n</ion-content>\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { OpportunityDetailsPage } from './opportunity-details.page';\r\nimport { OpportunityDetailsPageRoutingKeys } from './opportunity-details-routing.keys';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: `:${OpportunityDetailsPageRoutingKeys.PARAM_ID}`,\r\n    children: [\r\n      {\r\n        path: '',\r\n        component: OpportunityDetailsPage,\r\n        pathMatch: 'full',\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class OpportunityDetailsPageRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { CommonOpportunityService } from 'src/app/services/common/opportunity/opportunity.service';\r\nimport { Opportunity } from 'src/app/models/common/opportunity.model';\r\nimport { Subscription, from, forkJoin } from 'rxjs';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { OpportunityDetailsPageRoutingKeys } from './opportunity-details-routing.keys';\r\nimport { TestdrivePageRoutingKeys } from '../../testdrive/testdrives/testdrive-routing.keys';\r\nimport { TasksPageRoutingKeys } from '../../task/tasks-routing.keys';\r\nimport { AcitiviesPageRoutingKeys } from '../../logs/activities/activities-routing.keys';\r\nimport { OffersPageRoutingKeys } from '../../offer/offers-routing.keys';\r\nimport { BookingsPageRoutingKeys } from '../../booking/bookings/bookings-routing.keys';\r\nimport { DeliveriesPageRoutingKeys } from '../../delivery/deliveries/deliveries-routing.keys';\r\nimport { ModalController, LoadingController } from '@ionic/angular';\r\nimport { SelectorComponent } from 'src/app/components/common/selector/selector.component';\r\nimport { SelectOption } from 'src/app/models/common/select-option.model';\r\nimport { ErrorService } from 'src/app/services/common/error/error.service';\r\nimport { tap, map, mergeMap } from 'rxjs/operators';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { FormErrorMessages } from 'src/app/models/common/form-error.model';\r\nimport { FormGroup, Validators, FormBuilder } from '@angular/forms';\r\nimport { TradeinsPageRoutingKeys } from '../../tradein/tradeins/tradeins-routing.keys';\r\nimport { environment } from 'src/environments/environment';\r\nimport { OppConstant } from '../../../services/sg/opportunity/opportunity.constant';\r\nimport { ModelInterestSelectorComponent } from '../../../components/common/model-interest-selector/model-interest-selector.component';\r\nimport { Campaign } from 'src/app/models/common/campaign.model';\r\n\r\n@Component({\r\n  selector: 'app-opportunity-details',\r\n  templateUrl: './opportunity-details.page.html',\r\n  styleUrls: ['./opportunity-details.page.scss'],\r\n})\r\nexport class OpportunityDetailsPage implements OnInit {\r\n  private subs = new Subscription();\r\n  opp: Opportunity;\r\n  models: SelectOption[];\r\n  ppDateRange: SelectOption[];\r\n  cmpgList: Campaign[];\r\n  chnlList: string[];\r\n  oppForm: FormGroup;\r\n  formErrorMessages: FormErrorMessages;\r\n  countryCode = environment.countryCode;\r\n  customPPDate: string = OppConstant.PP_DATE_CUSTOM;\r\n  isPPDChanged: boolean;\r\n  ppDateMin: string;\r\n  ppDateMax: string;\r\n\r\n  constructor(\r\n    private opportunityService: CommonOpportunityService,\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private modalController: ModalController,\r\n    private translate: TranslateService,\r\n    private loadingCtrl: LoadingController,\r\n    private formBuilder: FormBuilder\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.oppForm = this.initOppForm();\r\n    this.subs.add(this.parseURL());\r\n  }\r\n\r\n  private initOppForm(): FormGroup {\r\n    const oppForm = this.formBuilder.group({\r\n      name: [''],\r\n      company: [''],\r\n      modelInterest: [[], [Validators.required]],\r\n      warmth: [0],\r\n      notes: [''],\r\n      PPD: [''],\r\n      PPDRange: [[''], [Validators.required]],\r\n      PPDReason: [''],\r\n      source: [],\r\n      channel: [],\r\n    });\r\n    this.initErrorMessages(oppForm);\r\n    return oppForm;\r\n  }\r\n\r\n  parseURL() {\r\n    this.opp = new Opportunity();\r\n    return this.route.paramMap.subscribe((params) => {\r\n      this.opp.Id = params.get(OpportunityDetailsPageRoutingKeys.PARAM_ID);\r\n      this.translate\r\n        .get('Common_Loading')\r\n        .pipe(\r\n          mergeMap((lang) => {\r\n            return from(\r\n              this.loadingCtrl.create({\r\n                message: lang,\r\n              })\r\n            );\r\n          }),\r\n          mergeMap((loading) => {\r\n            loading.present();\r\n            return forkJoin([\r\n              this.getOpportunities(this.opp.Id).pipe(\r\n                mergeMap((opp) => {\r\n                  return forkJoin([this.getPPRange(), this.getCmpgList()]);\r\n                })\r\n              ),\r\n            ]).pipe(\r\n              tap(\r\n                (e) => {\r\n                  this.isPPDChanged = undefined;\r\n                  this.updateForm();\r\n                  loading.dismiss();\r\n                },\r\n                (err) => {\r\n                  loading.dismiss();\r\n                }\r\n              )\r\n            );\r\n          })\r\n        )\r\n        .subscribe();\r\n    });\r\n  }\r\n\r\n  compareId(o1, o2) {\r\n    return o1 && o2 ? o1.Id === o2.Id : o1 === o2;\r\n  }\r\n\r\n  getPPRange() {\r\n    return this.opportunityService.getPPDateRange(this.opp.Company).pipe(\r\n      tap((e) => {\r\n        this.ppDateRange = e;\r\n        const opt = new SelectOption();\r\n        opt.label = this.customPPDate;\r\n        opt.value = this.customPPDate;\r\n        this.ppDateRange.push(opt);\r\n        const today = new Date();\r\n        today.setMonth(0);\r\n        today.setDate(1);\r\n        this.ppDateMin = today.toJSON();\r\n        const maxDate = new Date(today.getFullYear() + 1, 11, 31);\r\n        this.ppDateMax = maxDate.toJSON();\r\n      })\r\n    );\r\n  }\r\n\r\n  getCmpgList() {\r\n    return this.opportunityService.getCmpgList(this.opp.Company).pipe(\r\n      tap((e) => {\r\n        this.cmpgList = e;\r\n        this.chnlList = this.opp.Cmpg?.Channel;\r\n      })\r\n    );\r\n  }\r\n\r\n  private initErrorMessages(form: FormGroup) {\r\n    this.translate.get('Error_CannotBeEmpty').subscribe((lang) => {\r\n      this.formErrorMessages = {\r\n        group: {},\r\n      };\r\n      if (!form) {\r\n        return;\r\n      }\r\n      for (const key of Object.keys(form.controls)) {\r\n        switch (key) {\r\n          case 'modelInterest':\r\n            this.formErrorMessages[key] = {\r\n              required: lang,\r\n            };\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  getOpportunities(oppId: string) {\r\n    return this.opportunityService.getOpportunityById(oppId).pipe(\r\n      tap((e) => {\r\n        console.log(e);\r\n        this.opp = e;\r\n      })\r\n    );\r\n  }\r\n\r\n  updateForm() {\r\n    if (this.oppForm && this.opp) {\r\n      if (this.opp.IntentStatus === 'Hot') {\r\n        this.opp.Warmth = 100;\r\n      } else if (this.opp.IntentStatus === 'Warm') {\r\n        this.opp.Warmth = 50;\r\n      } else if (this.opp.IntentStatus === 'Cold') {\r\n        this.opp.Warmth = 0;\r\n      }\r\n      this.oppForm.reset(\r\n        {\r\n          name: this.opp.ContactName,\r\n          company: this.opp.Company,\r\n          channel: this.opp.Channel,\r\n          source: this.opp.Cmpg,\r\n          warmth: this.opp.Warmth,\r\n          modelInterest: this.opp.ModelInterest,\r\n          notes: this.opp.Notes,\r\n          PPD: this.opp.PlannedPurchasedDate,\r\n          PPDRange: this.opp.PlannedPurchaseDateRange,\r\n          PPDReason: this.opp.PlannedPurchaseDateReason,\r\n        },\r\n        { emitEvent: false }\r\n      );\r\n    }\r\n  }\r\n\r\n  getOppColor(oppStatus: string, opp: Opportunity) {\r\n    if (oppStatus === 'open') {\r\n      if (opp.IsClosed) {\r\n        return 'assets/icon/opportunity/unlock-disabled.svg';\r\n      } else {\r\n        return 'assets/icon/opportunity/unlock.svg';\r\n      }\r\n    } else if (oppStatus === 'closed') {\r\n      if (opp.IsClosed) {\r\n        return 'warning';\r\n      } else {\r\n        return 'medium';\r\n      }\r\n    } else {\r\n      if (opp.Type === 'DEFERRED') {\r\n        return 'warning';\r\n      } else {\r\n        return 'medium';\r\n      }\r\n    }\r\n  }\r\n\r\n  updateOppStatus(type: string) {\r\n    if (this.countryCode === 'my') {\r\n      if (type === 'open') {\r\n        this.opp.Type = 'OPEN';\r\n      } else if (type === 'deferred') {\r\n        this.opp.Type = 'DEFERRED';\r\n      } else {\r\n        this.opp.Type = 'LOST';\r\n      }\r\n    }\r\n  }\r\n\r\n  changePPD(evt: Event) {\r\n    // prevent event on initial loading\r\n    if (this.isPPDChanged === undefined) {\r\n      this.isPPDChanged = false;\r\n      return;\r\n    }\r\n    try {\r\n      this.isPPDChanged = false;\r\n      this.oppForm.controls['PPDReason'].clearValidators();\r\n      if (this.opp && this.opp.Id) {\r\n        const formValues = this.oppForm.value;\r\n        if (formValues['PPDRange'] === this.customPPDate) {\r\n          this.isPPDChanged = this.opp.PlannedPurchasedDate !== formValues['PPD'];\r\n        } else {\r\n          this.isPPDChanged = this.opp.PlannedPurchaseDateRange !== formValues['PPDRange'];\r\n        }\r\n      }\r\n\r\n      if (this.isPPDChanged) {\r\n        this.oppForm.controls['PPDReason'].setValidators([Validators.required]);\r\n      }\r\n\r\n      this.oppForm.controls['PPDReason'].updateValueAndValidity();\r\n    } catch (err) {\r\n      // this.err.logError(err);\r\n      // this.err.presentServerErr(err);\r\n    }\r\n  }\r\n\r\n  changeCmpgSource(evt: Event) {\r\n    if (this.oppForm.get('source') && this.oppForm.get('source').value instanceof Campaign) {\r\n      this.chnlList = this.oppForm.get('source').value.Channel;\r\n      if (this.chnlList.indexOf(this.oppForm.get('channel').value) < 0) {\r\n        this.oppForm.get('channel').reset([]);\r\n      }\r\n      if (this.oppForm.get('channel').disabled) {\r\n        this.oppForm.get('channel').enable();\r\n      }\r\n    } else {\r\n      this.oppForm.get('channel').disable();\r\n    }\r\n  }\r\n\r\n  showModelInterestComp() {\r\n    console.log(this.oppForm.get('company').value);\r\n    from(\r\n      this.modalController.create({\r\n        component: ModelInterestSelectorComponent,\r\n        componentProps: {\r\n          cmp: this.oppForm.get('company').value,\r\n          team: '',\r\n          selectedValues: '',\r\n        },\r\n      })\r\n    ).subscribe((modal) => {\r\n      from(modal.onDidDismiss()).subscribe((modalData) => {\r\n        if (modalData && modalData.data) {\r\n          const selectedModel: Array<string> = modalData.data.map((model) => model.label);\r\n          if (JSON.stringify(this.oppForm.get('modelInterest').value) !== JSON.stringify(selectedModel)) {\r\n            this.oppForm.get('modelInterest').setValue(selectedModel);\r\n            this.oppForm.markAsDirty();\r\n          }\r\n        }\r\n      });\r\n      modal.present();\r\n    });\r\n  }\r\n\r\n  goToTestdrives() {\r\n    this.router.navigate([`${TestdrivePageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToTasks() {\r\n    this.router.navigate([`${TasksPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToActivityLogs() {\r\n    this.router.navigate([`${AcitiviesPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToOffers() {\r\n    this.router.navigate([`${OffersPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToBookings() {\r\n    // this.router.navigate([`${BookingsPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToDeliveries() {\r\n    // this.router.navigate([`${DeliveriesPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  goToTradeIns() {\r\n    this.router.navigate([`${TradeinsPageRoutingKeys.BASE}/` + this.opp.Id]);\r\n  }\r\n\r\n  getFavIcon(opp: Opportunity) {\r\n    if (opp.Flag) {\r\n      return 'star';\r\n    } else {\r\n      return 'star-outline';\r\n    }\r\n  }\r\n\r\n  save() {\r\n    if (!this.oppForm.valid) {\r\n      console.log('invalid opp form!', this.oppForm);\r\n      if (this.oppForm.hasError('ppDateReason')) {\r\n        throw new Error(this.oppForm.getError('ppDateReason'));\r\n      }\r\n      return;\r\n    }\r\n    this.opp.ContactName = this.oppForm.get('name').value;\r\n    this.opp.Cmpg = this.oppForm.get('source').value;\r\n    this.opp.Channel = this.oppForm.get('channel').value;\r\n    this.opp.ModelInterest = this.oppForm.get('modelInterest').value;\r\n    this.opp.Company = this.oppForm.get('company').value;\r\n    this.opp.PlannedPurchaseDateRange = this.oppForm.get('PPDRange').value;\r\n    this.opp.PlannedPurchasedDate = this.oppForm.get('PPD').value;\r\n    this.opp.PlannedPurchaseDateReason = this.oppForm.get('PPDReason').value;\r\n    this.translate\r\n      .get('Common_Saving')\r\n      .pipe(\r\n        mergeMap((lang) => {\r\n          return from(\r\n            this.loadingCtrl.create({\r\n              message: lang,\r\n            })\r\n          );\r\n        })\r\n      )\r\n      .subscribe(\r\n        (loading) => {\r\n          loading.present();\r\n          return this.opportunityService.upsertOpp(this.opp).subscribe(\r\n            (res) => {\r\n              loading.dismiss();\r\n            },\r\n            (err) => {\r\n              loading.dismiss();\r\n              // add error service call\r\n            }\r\n          );\r\n        },\r\n        (err) => {\r\n          // add error service call\r\n        }\r\n      );\r\n  }\r\n}\r\n","import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { IonicModule } from '@ionic/angular';\r\nimport { ModelInterestSelectorComponent } from './model-interest-selector.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, IonicModule, FormsModule],\r\n  declarations: [ModelInterestSelectorComponent],\r\n  exports: [ModelInterestSelectorComponent],\r\n})\r\nexport class ModelInterestSelectorModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { OpportunityDetailsPageRoutingModule } from './opportunity-details-routing.module';\r\n\r\nimport { OpportunityDetailsPage } from './opportunity-details.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { SelectorComponentModule } from 'src/app/components/common/selector/selector.module';\r\nimport { ItemErrComponentModule } from 'src/app/components/common/item-err/item-err.module';\r\nimport { ModelInterestSelectorModule } from 'src/app/components/common/model-interest-selector/model-interest-selector.module';\r\nimport { ModelInterestSelectorComponent } from 'src/app/components/common/model-interest-selector/model-interest-selector.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    ReactiveFormsModule,\r\n    TranslateModule,\r\n    SelectorComponentModule,\r\n    ItemErrComponentModule,\r\n    OpportunityDetailsPageRoutingModule,\r\n    ModelInterestSelectorModule,\r\n  ],\r\n  declarations: [OpportunityDetailsPage],\r\n  entryComponents: [ModelInterestSelectorComponent],\r\n})\r\nexport class OpportunityDetailsPageModule {}\r\n"],"sourceRoot":"webpack:///"}