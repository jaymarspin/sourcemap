{"version":3,"sources":["./src/app/pages/tradein/tradeins/components/filter-tradein/filter-tradein.component.ts","./src/app/pages/tradein/tradeins/components/filter-tradein/filter-tradein.component.html","./src/app/pages/tradein/tradeins/tradeins.page.html","./src/app/pages/tradein/tradeins/tradeins-routing.module.ts","./src/app/pages/tradein/tradeins/tradeins.page.ts","./src/app/pages/tradein/tradeins/tradeins.module.ts"],"names":["FilterTradeinComponent","modalCtrl","this","filterObj","reset","tdStatus","source","dismiss","type","routes","path","PARAM_ID","children","component","TradeinsPage","route","router","tradeinSrvc","translate","loadingCtrl","alertCtrl","subs","Subscription","add","parseURL","paramMap","subscribe","params","oppId","get","getData","undefined","filter","tradeIn","pipe","mergeMap","lang","from","create","message","loading","present","console","log","getTradeIns","tap","e","tradeins","err","item","btns","backdropDismiss","alert","forkJoin","header","push","text","handler","updateOwner","buttons","owner","navigate","BASE","Id","animated","cssClass","componentProps","Object","assign","modal","onDidDismiss","res","data","pathMatch","TradeinsPageRoutingModule","forChild","TradeinsPageModule"],"mappings":"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","file":"39.5bf94e9c6f9e705d524c.js","sourcesContent":["import { Component, OnInit, Input } from '@angular/core';\r\nimport { TradeInFilterModel } from 'src/app/models/common/filter.model';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-filter-tradein',\r\n  templateUrl: './filter-tradein.component.html',\r\n  styleUrls: ['./filter-tradein.component.scss'],\r\n})\r\nexport class FilterTradeinComponent implements OnInit {\r\n  @Input() filterObj: TradeInFilterModel;\r\n\r\n  constructor(private modalCtrl: ModalController) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.filterObj) {\r\n      this.reset();\r\n    }\r\n  }\r\n\r\n  getData() {}\r\n\r\n  reset() {\r\n    this.filterObj = {\r\n      tdStatus: 'all',\r\n      source: '',\r\n    };\r\n  }\r\n\r\n  apply() {\r\n    this.modalCtrl.dismiss(this.filterObj);\r\n  }\r\n\r\n  cancel() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n\r\n  getUpcomingIcon() {\r\n    if (this.filterObj.tdStatus === 'upcoming') {\r\n      return 'assets/icon/opportunity/upcoming.svg';\r\n    } else {\r\n      return 'assets/icon/opportunity/upcoming-disabled.svg';\r\n    }\r\n  }\r\n\r\n  updateTdStatus(type: string) {\r\n    if (type === 'ongoing') {\r\n      this.filterObj.tdStatus = 'ongoing';\r\n    } else if (type === 'upcoming') {\r\n      this.filterObj.tdStatus = 'upcoming';\r\n    } else if (type === 'all') {\r\n      this.filterObj.tdStatus = 'all';\r\n    } else {\r\n      this.filterObj.tdStatus = 'completed';\r\n    }\r\n  }\r\n}\r\n","<p>filter-tradein works!</p>\r\n","<ion-header class=\"ion-no-border\">\r\n  <ion-toolbar color=\"primary\" mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button defaultHref=\"\" text=\"{{'Common_Back'|translate}}\"></ion-back-button>\r\n    </ion-buttons>\r\n    <!-- <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"showFilter()\">\r\n        <ion-icon slot=\"icon-only\" name=\"funnel\"></ion-icon>\r\n      </ion-button>\r\n    </ion-buttons> -->\r\n    <ion-title>\r\n      {{\"TradeInsPage_TradeIn\"|translate}}<br />\r\n      <ion-text *ngIf=\"oppId\" class=\"sub-header\"> {{\"TestdrivePage_OpportunityID\"|translate}}: {{oppId}} </ion-text>\r\n    </ion-title>\r\n  </ion-toolbar>\r\n  <ion-toolbar class=\"bg\" *ngIf=\"oppId\">\r\n    <ion-grid class=\"border ion-margin-start ion-margin-end ion-margin-top ion-padding ion-text-center\" (click)=\"add()\">\r\n      <ion-row>\r\n        <ion-col size=\"12\">\r\n          <ion-icon name=\"add-circle\" color=\"primary\" class=\"add-icon\"></ion-icon>\r\n          <ion-label color=\"primary\"> {{ \"TradeInsPage_NewTradeIn\" | translate }} </ion-label>\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content class=\"ion-padding-start ion-padding-end ion-padding-bottom\">\r\n  <ion-grid class=\"ion-margin-top ion-margin-bottom border-radius\" *ngFor=\"let tradein of tradeins\">\r\n    <ion-row class=\"ion-no-margin\">\r\n      <ion-col>\r\n        <ion-label><b>{{tradein?.OpportunityStage}}</b></ion-label\r\n        ><br />\r\n        <ion-label> {{tradein?.ContactName}} </ion-label>\r\n        <ion-icon class=\"bottom-icon\" src=\"assets/icon/tradein/inactive.svg\"></ion-icon>\r\n      </ion-col>\r\n      <ion-col class=\"ion-text-start\">\r\n        <ion-label class=\"break-line\">{{ tradein?.Chassis }} </ion-label>\r\n        <ion-label>{{ tradein?.Make }} </ion-label>\r\n        <ion-label>{{ tradein?.RegNo }}</ion-label><br />\r\n        <ion-label>{{ tradein?.Purchaser}}</ion-label><br />\r\n        <ion-label class=\"break-line\">{{ tradein?.CreatedDate | date: \"dd MMM y hh:mm a\" }} </ion-label>\r\n        <ion-label>\r\n          <a (click)=\"goToTradeIn(tradein)\"> {{\"TradeInsPage_ViewDetails\"|translate}} </a>\r\n        </ion-label>\r\n      </ion-col>\r\n    </ion-row>\r\n  </ion-grid>\r\n</ion-content>\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { TradeinsPage } from './tradeins.page';\r\nimport { TradeinsPageRoutingKeys } from './tradeins-routing.keys';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: `:${TradeinsPageRoutingKeys.PARAM_ID}`,\r\n    children: [\r\n      {\r\n        path: '',\r\n        component: TradeinsPage,\r\n        pathMatch: 'full',\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class TradeinsPageRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\nimport { AlertController, LoadingController, ModalController } from '@ionic/angular';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { forkJoin, from, Subscription } from 'rxjs';\r\nimport { mergeMap, tap } from 'rxjs/operators';\r\nimport { TradeInFilterModel } from 'src/app/models/common/filter.model';\r\nimport { TradeIn } from 'src/app/models/common/tradein.model';\r\nimport { CommonTradeinService } from 'src/app/services/common/tradein/tradein.service';\r\nimport { NewLeadsRoutingKeys } from '../../new-leads/new-leads-routing.keys';\r\nimport { TradeinUpdateProfilePageRoutingKeys } from '../edit-tradein/update-profile/update-profile-routing.keys';\r\nimport { TradeinViewProfilePageRoutingKeys } from '../view-tradein/view-tradein-routing.keys';\r\nimport { FilterTradeinComponent } from './components/filter-tradein/filter-tradein.component';\r\nimport { TradeinsPageRoutingKeys } from './tradeins-routing.keys';\r\n\r\n@Component({\r\n  selector: 'app-tradeins',\r\n  templateUrl: './tradeins.page.html',\r\n  styleUrls: ['./tradeins.page.scss'],\r\n})\r\nexport class TradeinsPage implements OnInit {\r\n  private subs = new Subscription();\r\n  tradeins: TradeIn[];\r\n  oppId: string;\r\n  filterObj: TradeInFilterModel;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private tradeinSrvc: CommonTradeinService,\r\n    private modalCtrl: ModalController,\r\n    private translate: TranslateService,\r\n    private loadingCtrl: LoadingController,\r\n    private alertCtrl: AlertController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.subs.add(this.parseURL());\r\n  }\r\n\r\n  parseURL() {\r\n    return this.route.paramMap.subscribe((params) => {\r\n      this.oppId = params.get(TradeinsPageRoutingKeys.PARAM_ID);\r\n      if (this.oppId === TradeinsPageRoutingKeys.PARAM_ID) {\r\n        this.oppId = '';\r\n      }\r\n      this.getData(undefined, undefined, this.oppId);\r\n    });\r\n  }\r\n\r\n  getData(filter: TradeInFilterModel, tradeIn: string, oppId: string) {\r\n    return this.translate\r\n      .get('Common_Loading')\r\n      .pipe(\r\n        mergeMap((lang) => {\r\n          return from(\r\n            this.loadingCtrl.create({\r\n              message: lang,\r\n            })\r\n          );\r\n        }),\r\n        mergeMap((loading) => {\r\n          loading.present();\r\n          console.log(oppId);\r\n          return this.tradeinSrvc.getTradeIns(filter, tradeIn, oppId).pipe(\r\n            tap(\r\n              (e) => {\r\n                this.tradeins = e;\r\n                console.log(this.tradeins);\r\n                loading.dismiss();\r\n              },\r\n              (err) => {\r\n                loading.dismiss();\r\n              }\r\n            )\r\n          );\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  goToTestdrive(item: TradeIn) {\r\n    // this.router.navigate([`${ViewTestdrivePageRoutingKeys.BASE}/${item.Id}`]);\r\n  }\r\n\r\n  add() {\r\n    const btns = [];\r\n    from(\r\n      this.alertCtrl.create({\r\n        backdropDismiss: false,\r\n      })\r\n    )\r\n      .pipe(\r\n        mergeMap((alert) => {\r\n          return forkJoin([\r\n            this.translate.get('TradeInsPage_IsOwner').pipe(\r\n              tap((lang) => {\r\n                alert.header = lang;\r\n              })\r\n            ),\r\n            this.translate.get('TradeInsPage_OneOption').pipe(\r\n              tap((lang) => {\r\n                alert.message = lang;\r\n              })\r\n            ),\r\n            this.translate.get('Common_No').pipe(\r\n              tap((lang) => {\r\n                btns.push({\r\n                  text: lang,\r\n                  handler: () => {\r\n                    this.updateOwner(false);\r\n                  },\r\n                });\r\n              })\r\n            ),\r\n            this.translate.get('Common_Yes').pipe(\r\n              tap((lang) => {\r\n                btns.push({\r\n                  text: lang,\r\n                  handler: () => {\r\n                    this.updateOwner(true);\r\n                  },\r\n                });\r\n              })\r\n            ),\r\n          ]).pipe(\r\n            tap(() => {\r\n              alert.buttons = btns;\r\n              alert.present();\r\n            })\r\n          );\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  updateOwner(owner: boolean) {\r\n    if (owner) {\r\n      this.router.navigate([`${TradeinUpdateProfilePageRoutingKeys.BASE}/${this.oppId}/${owner}`]);\r\n    } else {\r\n      this.router.navigate([`${NewLeadsRoutingKeys.BASE}/${this.oppId}`]);\r\n    }\r\n  }\r\n\r\n  goToTradeIn(item: TradeIn) {\r\n    this.router.navigate([`${TradeinViewProfilePageRoutingKeys.BASE}/${item.Id}`]);\r\n  }\r\n\r\n  showFilter() {\r\n    from(\r\n      this.modalCtrl.create({\r\n        component: FilterTradeinComponent,\r\n        backdropDismiss: false,\r\n        animated: true,\r\n        cssClass: 'full-screen',\r\n        componentProps: {\r\n          filterObj: this.filterObj ? Object.assign({}, this.filterObj) : null,\r\n        },\r\n      })\r\n    ).subscribe((modal) => {\r\n      from(modal.onDidDismiss()).subscribe((res: any) => {\r\n        if (res && res.data) {\r\n          this.filterObj = res.data;\r\n          this.getData(this.filterObj, undefined, this.oppId);\r\n        }\r\n      });\r\n      modal.present();\r\n    });\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { TradeinsPageRoutingModule } from './tradeins-routing.module';\r\n\r\nimport { TradeinsPage } from './tradeins.page';\r\nimport { FilterTradeinComponent } from './components/filter-tradein/filter-tradein.component';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, FormsModule, IonicModule, TranslateModule, TradeinsPageRoutingModule],\r\n  declarations: [TradeinsPage, FilterTradeinComponent],\r\n})\r\nexport class TradeinsPageModule {}\r\n"],"sourceRoot":"webpack:///"}