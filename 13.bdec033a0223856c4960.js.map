{"version":3,"sources":["./src/app/services/common/offer/offer.service.ts","./src/app/pages/offer/components/filter-offer/filter-offer.component.ts","./src/app/pages/offer/components/filter-offer/filter-offer.component.html","./src/app/pages/offer/offers.page.html","./src/app/pages/offer/offers-routing.module.ts","./src/app/pages/offer/offers.page.ts","./src/app/pages/offer/offers.module.ts","./src/app/pages/offer/view-offer/view-offer-routing.keys.ts"],"names":["CommonOfferService","offerAPI","errorSrvc","oppId","filter","id","this","getOffers","e","presentServerErr","keyword","getOffersByKeyword","offerId","trim","getOfferById","FilterOfferComponent","modalCtrl","filterObj","reset","offerStatus","dismiss","type","cancel","updateOfferStatus","apply","routes","path","PARAM_ID","children","component","OffersPage","route","router","offerSrvc","translate","loadingCtrl","subs","Subscription","add","parseURL","paramMap","subscribe","params","get","pipe","mergeMap","lang","from","create","message","loading","present","tap","offers","err","item","navigate","BASE","Id","offer","Status","toLocaleLowerCase","state","Object","STATE_OPPID","backdropDismiss","animated","cssClass","componentProps","assign","modal","onDidDismiss","res","data","console","log","searchInput","showFilter","pathMatch","loadChildren","then","m","EditOfferPageModule","ViewOfferPageModule","OffersPageRoutingModule","forChild","OffersPageModule","ViewOfferPageRoutingKeys"],"mappings":"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","file":"13.bdec033a0223856c4960.js","sourcesContent":["import { Injectable, Inject } from '@angular/core';\r\nimport { IOfferApi } from 'src/app/interfaces/offer-api.interface';\r\nimport { OFFER_SERVICE_KEY } from 'src/app/service-providers/dynamic-key.provider';\r\nimport { ErrorService } from '../error/error.service';\r\nimport { Offer } from 'src/app/models/common/offer.model';\r\nimport { Observable } from 'rxjs';\r\nimport { OfferFilterModel } from 'src/app/models/common/filter.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class CommonOfferService {\r\n  constructor(@Inject(OFFER_SERVICE_KEY) private offerAPI: IOfferApi, private errorSrvc: ErrorService) {}\r\n\r\n  getOffers(oppId?: string, filter?: OfferFilterModel): Observable<Offer[]> {\r\n    const id = oppId ? oppId : '';\r\n    try {\r\n      return this.offerAPI.getOffers(id, filter);\r\n    } catch (e) {\r\n      this.errorSrvc.presentServerErr(e);\r\n    }\r\n  }\r\n\r\n  getOffersByKeyword(oppId: string, keyword: string): Observable<Offer[]> {\r\n    try {\r\n      return this.offerAPI.getOffersByKeyword(oppId, keyword);\r\n    } catch (e) {\r\n      this.errorSrvc.presentServerErr(e);\r\n    }\r\n  }\r\n\r\n  getOfferById(offerId: string): Observable<Offer> {\r\n    try {\r\n      if (offerId && offerId.trim()) {\r\n        return this.offerAPI.getOfferById(offerId);\r\n      }\r\n    } catch (e) {\r\n      this.errorSrvc.presentServerErr(e);\r\n    }\r\n  }\r\n}\r\n","import { Component, OnInit, Input } from '@angular/core';\r\nimport { OfferFilterModel } from 'src/app/models/common/filter.model';\r\nimport { ModalController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-filter-offer',\r\n  templateUrl: './filter-offer.component.html',\r\n  styleUrls: ['./filter-offer.component.scss'],\r\n})\r\nexport class FilterOfferComponent implements OnInit {\r\n  @Input() filterObj: OfferFilterModel;\r\n\r\n  constructor(private modalCtrl: ModalController) {}\r\n\r\n  ngOnInit() {\r\n    if (!this.filterObj) {\r\n      this.reset();\r\n    }\r\n  }\r\n\r\n  getData() {}\r\n\r\n  reset() {\r\n    this.filterObj = {\r\n      offerStatus: 'all',\r\n    };\r\n  }\r\n\r\n  apply() {\r\n    this.modalCtrl.dismiss(this.filterObj);\r\n  }\r\n\r\n  cancel() {\r\n    this.modalCtrl.dismiss();\r\n  }\r\n\r\n  getUpcomingIcon() {\r\n    if (this.filterObj.offerStatus === 'upcoming') {\r\n      return 'assets/icon/opportunity/upcoming.svg';\r\n    } else {\r\n      return 'assets/icon/opportunity/upcoming-disabled.svg';\r\n    }\r\n  }\r\n\r\n  updateOfferStatus(type: string) {\r\n    if (type === 'active') {\r\n      this.filterObj.offerStatus = 'active';\r\n    } else if (type === 'rejected') {\r\n      this.filterObj.offerStatus = 'rejected';\r\n    } else if (type === 'all') {\r\n      this.filterObj.offerStatus = 'all';\r\n    } else {\r\n      this.filterObj.offerStatus = 'accepted';\r\n    }\r\n  }\r\n}\r\n","<ion-header class=\"ion-no-border\">\r\n  <ion-toolbar color=\"primary\" mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-button (click)=\"cancel()\">\r\n        <ion-icon slot=\"icon-only\" name=\"arrow-back\"></ion-icon>\r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"reset()\">\r\n        {{ 'OffersFilter_Reset' | translate }}\r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-title>{{ 'OffersFilter_Filter' | translate }}</ion-title>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content>\r\n  <div class=\"ion-padding\">\r\n    <ion-grid class=\"ion-no-margin ion-no-padding\">\r\n      <ion-row>\r\n        <ion-col size=\"12\">\r\n          <ion-label>\r\n            {{ 'OffersFilter_OfferStatus' | translate }}\r\n          </ion-label>\r\n        </ion-col>\r\n      </ion-row>\r\n      <ion-row class=\"ion-text-center ion-padding-top\">\r\n        <ion-col>\r\n          <div class=\"header-btn\" (click)=\"updateOfferStatus('all')\" [class.activated]=\"filterObj.offerStatus === 'all'\">\r\n            <span>\r\n              <ion-icon name=\"apps\" [color]=\"filterObj.offerStatus === 'all' ? 'primary' : 'medium'\"></ion-icon>\r\n            </span>\r\n            <div>\r\n              <ion-label class=\"mat-small\">\r\n                {{ 'OffersFilter_All' | translate }}\r\n              </ion-label>\r\n            </div>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col>\r\n          <div class=\"header-btn\" (click)=\"updateOfferStatus('active')\" [class.activated]=\"filterObj.offerStatus === 'active'\">\r\n            <span>\r\n              <ion-icon name=\"play\" [color]=\"filterObj.offerStatus === 'active' ? 'primary' : 'medium'\"></ion-icon>\r\n            </span>\r\n            <div>\r\n              <ion-label class=\"mat-small\">\r\n                {{ 'OffersFilter_Active' | translate }}\r\n              </ion-label>\r\n            </div>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col>\r\n          <div class=\"header-btn\" (click)=\"updateOfferStatus('accepted')\" [class.activated]=\"filterObj.offerStatus === 'accepted'\">\r\n            <span>\r\n              <ion-icon name=\"checkmark\" [color]=\"filterObj.offerStatus === 'accepted' ? 'primary' : 'medium'\"></ion-icon>\r\n            </span>\r\n            <div>\r\n              <ion-label class=\"mat-small\">\r\n                {{ 'OffersFilter_Accepted' | translate }}\r\n              </ion-label>\r\n            </div>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col>\r\n          <div class=\"header-btn\" (click)=\"updateOfferStatus('rejected')\" [class.activated]=\"filterObj.offerStatus === 'rejected'\">\r\n            <span>\r\n              <ion-icon name=\"close\" [color]=\"filterObj.offerStatus === 'rejected' ? 'primary' : 'medium'\"></ion-icon>\r\n            </span>\r\n            <div>\r\n              <ion-label class=\"mat-small\">\r\n                {{ 'OffersFilter_Declined' | translate }}\r\n              </ion-label>\r\n            </div>\r\n          </div>\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </div>\r\n</ion-content>\r\n<ion-footer class=\"ion-padding\">\r\n  <ion-button fill=\"solid\" expand=\"block\" color=\"primary\" (click)=\"apply()\">\r\n    {{ 'Common_Apply' | translate }}\r\n  </ion-button>\r\n</ion-footer>\r\n","<ion-header class=\"ion-no-border\">\r\n  <ion-toolbar color=\"primary\" mode=\"ios\">\r\n    <ion-buttons slot=\"start\">\r\n      <ion-back-button defaultHref=\"\" text=\"{{'Common_Back'|translate}}\"></ion-back-button>\r\n    </ion-buttons>\r\n    <ion-buttons slot=\"end\">\r\n      <ion-button (click)=\"showFilter()\">\r\n        <ion-icon slot=\"icon-only\" name=\"funnel\"></ion-icon>\r\n      </ion-button>\r\n    </ion-buttons>\r\n    <ion-title>\r\n      {{\"OffersPage_Offers\"|translate}} <br />\r\n      <ion-text *ngIf=\"oppId\" class=\"sub-header\"> {{\"TestdrivePage_OpportunityID\"|translate}}: {{oppId}} </ion-text>\r\n    </ion-title>\r\n  </ion-toolbar>\r\n  <ion-toolbar class=\"bg\" *ngIf=\"oppId\">\r\n    <ion-searchbar\r\n      class=\"ion-margin-top ion-no-padding ion-padding-start ion-padding-end\"\r\n      search-icon=\"\"\r\n      debounce=\"500\"\r\n      [(ngModel)]=\"searchInput\"\r\n      placeholder=\"{{'OffersPage_Search'|translate}}\"\r\n      (ionChange)=\"search()\"\r\n      (ionCancel)=\"getOffers()\"\r\n      (ionClear)=\"getOffers()\"\r\n    >\r\n    </ion-searchbar>\r\n  </ion-toolbar>\r\n  <ion-toolbar class=\"bg\" *ngIf=\"oppId\">\r\n    <div class=\"border ion-margin-start ion-margin-end ion-padding ion-text-center\" (click)=\"add()\">\r\n      <ion-icon name=\"add-circle\" color=\"primary\" class=\"add-icon\"></ion-icon>\r\n      <ion-label color=\"primary\"> {{ \"OffersPage_AddOffer\" | translate }} </ion-label>\r\n    </div>\r\n  </ion-toolbar>\r\n</ion-header>\r\n<ion-content class=\"ion-padding-start ion-padding-end ion-padding-bottom\">\r\n  <div class=\"ion-margin-top ion-margin-bottom border-radius\" *ngFor=\"let item of offers\">\r\n    <ion-grid class=\"ion-no-margin\">\r\n      <ion-row>\r\n        <ion-col>\r\n          <div class=\"ion-margin-bottom\">\r\n            <ion-label><b>{{item?.Status}}</b></ion-label\r\n            ><br />\r\n            <ion-label>\r\n              <b>{{item?.ContactName}}</b>\r\n            </ion-label>\r\n          </div>\r\n          <div class=\"bottom-icon\">\r\n            <ion-icon name=\"document\"></ion-icon>\r\n          </div>\r\n        </ion-col>\r\n        <ion-col class=\"ion-text-start\">\r\n          <ion-label>{{ item?.VariantName }}</ion-label><br />\r\n          <ion-label>{{ item?.CreatedDate | date: \"dd MMM y hh:mm a\" }}</ion-label><br />\r\n          <ion-label>\r\n            <a (click)=\"view(item)\"> {{\"OffersPage_ViewDetails\"|translate}} </a>\r\n          </ion-label>\r\n        </ion-col>\r\n      </ion-row>\r\n    </ion-grid>\r\n  </div>\r\n</ion-content>\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { OffersPage } from './offers.page';\r\nimport { OffersPageRoutingKeys } from './offers-routing.keys';\r\nimport { EditOfferPageRoutingKeys } from './edit-offer/edit-offer-routing.keys';\r\nimport { ViewOfferPageRoutingKeys } from './view-offer/view-offer-routing.keys';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: `:${OffersPageRoutingKeys.PARAM_ID}`,\r\n    children: [\r\n      {\r\n        path: '',\r\n        component: OffersPage,\r\n        pathMatch: 'full',\r\n      },\r\n      {\r\n        path: `${EditOfferPageRoutingKeys.BASE}`,\r\n        loadChildren: () => import('./edit-offer/edit-offer.module').then((m) => m.EditOfferPageModule),\r\n      },\r\n      {\r\n        path: `${ViewOfferPageRoutingKeys.BASE}`,\r\n        loadChildren: () => import('./view-offer/view-offer.module').then((m) => m.ViewOfferPageModule),\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class OffersPageRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Offer } from 'src/app/models/common/offer.model';\r\nimport { Subscription, from } from 'rxjs';\r\nimport { ActivatedRoute, Router, NavigationExtras } from '@angular/router';\r\nimport { OffersPageRoutingKeys } from './offers-routing.keys';\r\nimport { CommonOfferService } from 'src/app/services/common/offer/offer.service';\r\nimport { EditOfferPageRoutingKeys } from './edit-offer/edit-offer-routing.keys';\r\nimport { ViewOfferPageRoutingKeys } from './view-offer/view-offer-routing.keys';\r\nimport { TranslateService } from '@ngx-translate/core';\r\nimport { LoadingController, ModalController } from '@ionic/angular';\r\nimport { mergeMap, tap } from 'rxjs/operators';\r\nimport { OfferFilterModel } from 'src/app/models/common/filter.model';\r\nimport { FilterOfferComponent } from './components/filter-offer/filter-offer.component';\r\n\r\n@Component({\r\n  selector: 'app-offers',\r\n  templateUrl: './offers.page.html',\r\n  styleUrls: ['./offers.page.scss'],\r\n})\r\nexport class OffersPage implements OnInit {\r\n  private subs = new Subscription();\r\n  offers: Offer[];\r\n  oppId: string;\r\n  filterObj: OfferFilterModel;\r\n  searchInput: string;\r\n\r\n  constructor(\r\n    private route: ActivatedRoute,\r\n    private router: Router,\r\n    private offerSrvc: CommonOfferService,\r\n    private translate: TranslateService,\r\n    private loadingCtrl: LoadingController,\r\n    private modalCtrl: ModalController\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.subs.add(this.parseURL());\r\n  }\r\n\r\n  parseURL() {\r\n    return this.route.paramMap.subscribe((params) => {\r\n      this.oppId = params.get(OffersPageRoutingKeys.PARAM_ID);\r\n      if (this.oppId === OffersPageRoutingKeys.PARAM_ID) {\r\n        this.oppId = '';\r\n      }\r\n      this.getOffers(null);\r\n    });\r\n  }\r\n\r\n  getOffers(filter?: OfferFilterModel) {\r\n    this.translate\r\n      .get('Common_Loading')\r\n      .pipe(\r\n        mergeMap((lang) => {\r\n          return from(\r\n            this.loadingCtrl.create({\r\n              message: lang,\r\n            })\r\n          );\r\n        }),\r\n        mergeMap((loading) => {\r\n          loading.present();\r\n          return this.offerSrvc.getOffers(this.oppId, filter).pipe(\r\n            tap(\r\n              (e) => {\r\n                this.offers = e;\r\n                loading.dismiss();\r\n              },\r\n              (err) => {\r\n                loading.dismiss();\r\n              }\r\n            )\r\n          );\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n\r\n  goToOffer(item: Offer) {\r\n    this.router.navigate([`${OffersPageRoutingKeys.BASE}/${this.oppId}/${EditOfferPageRoutingKeys.BASE}/${item.Id}`]);\r\n  }\r\n\r\n  getColor(offer: Offer) {\r\n    if (offer.Status.toLocaleLowerCase() === 'accept') {\r\n      return 'accepted';\r\n    } else if (offer.Status.toLocaleLowerCase() === 'reject') {\r\n      return 'rejected';\r\n    } else {\r\n      return 'pending';\r\n    }\r\n  }\r\n\r\n  add() {\r\n    const state = new Object();\r\n    state[EditOfferPageRoutingKeys.STATE_OPPID] = this.oppId;\r\n    const navigationExtras: NavigationExtras = {\r\n      state,\r\n    };\r\n    this.router.navigate(\r\n      [`${OffersPageRoutingKeys.BASE}/${this.oppId}/${EditOfferPageRoutingKeys.BASE}/${EditOfferPageRoutingKeys.PARAM_ID}`],\r\n      navigationExtras\r\n    );\r\n  }\r\n\r\n  view(offer: Offer) {\r\n    this.router.navigate([`${OffersPageRoutingKeys.BASE}/${this.oppId}/${ViewOfferPageRoutingKeys.BASE}/${offer.Id}`]);\r\n  }\r\n\r\n  showFilter() {\r\n    from(\r\n      this.modalCtrl.create({\r\n        component: FilterOfferComponent,\r\n        backdropDismiss: false,\r\n        animated: true,\r\n        cssClass: 'full-screen',\r\n        componentProps: {\r\n          filterObj: this.filterObj ? Object.assign({}, this.filterObj) : null,\r\n        },\r\n      })\r\n    ).subscribe((modal) => {\r\n      from(modal.onDidDismiss()).subscribe((res: any) => {\r\n        if (res && res.data) {\r\n          this.filterObj = res.data;\r\n          console.log(this.filterObj);\r\n          this.getOffers(this.filterObj);\r\n        }\r\n      });\r\n      modal.present();\r\n    });\r\n  }\r\n\r\n  search() {\r\n    this.translate\r\n      .get('Common_Loading')\r\n      .pipe(\r\n        mergeMap((lang) => {\r\n          return from(\r\n            this.loadingCtrl.create({\r\n              message: lang,\r\n            })\r\n          );\r\n        }),\r\n        mergeMap((loading) => {\r\n          loading.present();\r\n          return this.offerSrvc.getOffersByKeyword(this.oppId, this.searchInput).pipe(\r\n            tap(\r\n              (e) => {\r\n                this.offers = e;\r\n                loading.dismiss();\r\n              },\r\n              (err) => {\r\n                loading.dismiss();\r\n              }\r\n            )\r\n          );\r\n        })\r\n      )\r\n      .subscribe();\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { OffersPageRoutingModule } from './offers-routing.module';\r\n\r\nimport { OffersPage } from './offers.page';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { CustomCurrencyPipe } from 'src/app/pipes/custom-currency.pipe';\r\nimport { FilterOfferComponent } from './components/filter-offer/filter-offer.component';\r\n\r\n@NgModule({\r\n  imports: [CommonModule, FormsModule, TranslateModule, IonicModule, OffersPageRoutingModule],\r\n  declarations: [OffersPage, FilterOfferComponent],\r\n})\r\nexport class OffersPageModule {}\r\n","export const ViewOfferPageRoutingKeys = {\r\n  BASE: 'view-offer',\r\n  PARAM_ID: 'new',\r\n};\r\n"],"sourceRoot":"webpack:///"}